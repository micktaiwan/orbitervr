<head>
  <title>orbitervr</title>
  <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
  <script src="https://mixedreality.mozilla.org/ammo.js/builds/ammo.wasm.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/n5ro/aframe-physics-system@v4.0.1/dist/aframe-physics-system.min.js"></script>
  <script src="collider-check.js"></script>
  <script src="listener.js"></script>
  <script src="velocity.js"></script>
  <script src="intersection-spawn.js"></script>
  <script src="snap.js"></script>
  <script src="random-color.js"></script>
</head>

<body>
  {{> scene}}
</body>

<template name="scene">
  <a-scene physics="driver: ammo">
    <a-entity cursor="rayOrigin:mouse"></a-entity>
    <a-assets>
      <img id="groundTexture" src="https://cdn.aframe.io/a-painter/images/floor.jpg" crossorigin="anonymous" />
      <img id="skyTexture" src="https://cdn.aframe.io/a-painter/images/sky.jpg" crossorigin="anonymous" />
      <a-mixin id="voxel" geometry="primitive: box; height: 0.5; width: 0.5; depth: 0.5" material="shader: standard" random-color snap="offset: 0.25 0.25 0.25; snap: 0.5 0.5 0.5" class="collidable" intersection-spawn="event: click; mixin: voxel" ammo-body="type: static; emitCollisionEvents: true;" ammo-shape="type: box"></a-mixin>
    </a-assets>

    <a-entity id="rig" position="0 1.7 0">
      <!-- camera -->
      <a-entity id="camera" camera look-controls wasd-controls>
        <!-- head -->
        <a-box position="0 0 0" rotation="0 0 0" color="#fa9" shadow ammo-body="type: static; emitCollisionEvents: true;" ammo-shape="type: box" width="1" height="1" depth="0.5"></a-box>
      </a-entity>


      <!-- hands -->
      <a-entity laser-controls="hand: right" raycaster="objects: .collidable;" listener-right></a-entity>
      <a-entity laser-controls="hand: left" raycaster="objects: .collidable;" listener-left></a-entity>
    </a-entity>

    <!-- texts -->
    {{> text}}
    <a-text value="Debug" position="-2.5 7 -8" color="#fff" scale="2 2 2" align="left" geometry="primitive: plane; width: 10.75" material="color: #333"></a-text>

    <a-text value="Bon ben c'est deja ca" position="-1.5 5.3 -10" color="#fff" scale="2 2 2"></a-text>
    <a-text value="WASD, ou joystick" position="-1.5 5 -10" color="#fff"></a-text>
    <a-sky color="#333333"></a-sky>

    <a-entity light="type: point; color: #fff; intensity: 0.8; distance: 0" position="0 0 0"></a-entity>
    <a-entity light="type: point; color: #f4f4f4; intensity: 0.5; distance: 0" position="-20 -7 -40"></a-entity>
    <a-entity light="type: ambient; color: #f4f4f4; intensity: 0.5;" position="0 -5 -5"></a-entity>

    <!-- cylinder -->
    <a-cylinder position="5 0.75 -3" radius="0.5" height="1.5" color="#FFC65D" shadow class="collidable" event-set__enter="_event: mouseenter; _target: #cylinderText; visible: true" event-set__leave="_event: mouseleave; _target: #cylinderText; visible: false" animation="startEvents: click; property: scale;
        from: 2 2 2; to: 1 1 1; dur: 500">
      >
      <a-text id="cylinderText" value="Hello Dayd" align="center" color="#FFF" visible="false" position="0 -0.55 0.55" geometry="primitive: plane; width: 1.75" material="color: #333"></a-text>
    </a-cylinder>

    <!-- big box -->
    <a-entity id="box" cursor-listener geometry="primitive: box; height: 3; width: 3; depth: 3" material="color: #345" position="-1 20 -11" rotation="0 25 25" shadow ammo-body="type: dynamic; emitCollisionEvents: true;" ammo-shape="type: box"></a-entity>

    <!-- light blue box -->
    <a-box position="2 4 -10" rotation="0 0 0" color="#4CC3D9" shadow event-set__enter="_event: mouseenter; color: #8FF7FF" event-set__leave="_event: mouseleave; color: #4CC3D9" velocity="0 0 0" toggle-velocity="axis: x; min: -10; max: 10;" ammo-body="type: dynamic; emitCollisionEvents: true;" ammo-shape="type: box" width="1" height="1" depth="1"></a-box>

    <!-- moving orange -->
    <a-box position="0 0.5 -10" rotation="0 0 0" color="#F90" shadow velocity="0 0 0" toggle-velocity="axis: x; min: -10; max: 10;" ammo-body="type: static; emitCollisionEvents: true;" ammo-shape="type: box" width="1" height="1" depth="1"></a-box>

    <!-- ground -->
    <a-cylinder id="ground" ammo-body="type: static" ammo-shape="type: cylinder" class="collidable" src="#groundTexture" radius="32" height="0.1" intersection-spawn="event: click; mixin: voxel"></a-cylinder>

    <a-sky id="bg" radius="30" src="#skyTexture" theta-length="90"></a-sky>
  </a-scene>
</template>